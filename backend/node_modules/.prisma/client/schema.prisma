datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id           Int          @id @default(autoincrement())
  email        String       @unique
  passwordHash String       @map("password_hash")
  fullName     String?      @map("full_name")
  role         Role         @default(STUDENT)
  createdAt    DateTime     @default(now()) @map("created_at")
  updatedAt    DateTime     @updatedAt @map("updated_at")
  isDeleted    Boolean      @default(false) @map("is_deleted")
  enrollments  Enrollment[]

  @@map("users")
}

model Course {
  id          Int          @id @default(autoincrement())
  code        String       @unique
  title       String
  description String?
  credits     Int          @default(3)
  createdAt   DateTime     @default(now()) @map("created_at")
  updatedAt   DateTime     @updatedAt @map("updated_at")
  isDeleted   Boolean      @default(false) @map("is_deleted")
  enrollments Enrollment[]

  @@map("courses")
}

model Enrollment {
  id            Int              @id @default(autoincrement())
  user          User             @relation(fields: [userId], references: [id])
  userId        Int              @map("user_id")
  course        Course           @relation(fields: [courseId], references: [id])
  courseId      Int              @map("course_id")
  status        EnrollmentStatus @default(NOT_STARTED)
  grade         String?
  creditsEarned Int              @default(0) @map("credits_earned")
  enrolledAt    DateTime         @default(now()) @map("enrolled_at")
  completedAt   DateTime?        @map("completed_at")
  isDeleted     Boolean          @default(false) @map("is_deleted")

  @@unique([userId, courseId])
  @@map("enrollments")
}

enum Role {
  STUDENT
  INSTRUCTOR
  ADMIN
}

enum EnrollmentStatus {
  NOT_STARTED
  IN_PROGRESS
  COMPLETED
}
